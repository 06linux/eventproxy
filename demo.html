<!DOCTYPE html>
<html>
<head>
<script src="event.emitter.js"></script>
</head>
<body>
<script>
var emitter = new EventEmitter();
emitter.await = function () {
    var callback = [].pop.apply(arguments, []);
    var args = [].slice.apply(arguments, [0, arguments.length]);
    var _map = {};
    for (var i = 0; i < args.length; i++) {
        _map[args[i]] = {
                "triggered" : false,
                "data": null;
            };
    }
    emitter.on("all", function (eventName, data) {
        console.log(arguments);
        if (eventName in _map) {
            _map[eventName].triggered = true;
            _map[eventName].data = data;
        }
        var trigger = true;
        var data = [];
        for (var index in _map) {
            if (!_map[eventName].triggered) {
                return;
            } else {
                
            }
        }
    });
};

emitter.on("hello", function (data) {
    console.log(data.hello);
});
emitter.await("hello", "world", function (data) {
    console.log(data.hello);
});

setTimeout(function () {
    emitter.trigger("hello", {hello: "world!"});
}, 10000);
setTimeout(function () {
    emitter.trigger("world", {hello: "world!"});
}, 15000);
</script>
</body>
</html>